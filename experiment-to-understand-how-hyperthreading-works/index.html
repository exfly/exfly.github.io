<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>超线程是如何工作的 - 实验 - ExflyBlog</title><meta name="Description" content="ExflyBlog, IT technology sharing, technology blog"><meta property="og:title" content="超线程是如何工作的 - 实验" />
<meta property="og:description" content="文章简介：通过一个实验理解超线程是如何工作的" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" /><meta property="og:image" content="https://exfly.github.io/media/img/avatar.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-11-03T11:59:48+00:00" />
<meta property="article:modified_time" content="2024-11-03T21:39:02+08:00" /><meta property="og:site_name" content="ExflyBlog" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://exfly.github.io/media/img/avatar.jpg" /><meta name="twitter:title" content="超线程是如何工作的 - 实验"/>
<meta name="twitter:description" content="文章简介：通过一个实验理解超线程是如何工作的"/>
<meta name="application-name" content="Exfly">
<meta name="apple-mobile-web-app-title" content="Exfly"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" /><link rel="prev" href="https://exfly.github.io/why-sysbench-dont-reconnect-after-kill/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "超线程是如何工作的 - 实验",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/exfly.github.io\/experiment-to-understand-how-hyperthreading-works\/"
        },"image": ["https:\/\/exfly.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "debug, cpu, intel, ","wordcount":  2898 ,
        "url": "https:\/\/exfly.github.io\/experiment-to-understand-how-hyperthreading-works\/","datePublished": "2024-11-03T11:59:48+00:00","dateModified": "2024-11-03T21:39:02+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/exfly.github.io\/media\/img\/avatar.jpg"},"author": {
                "@type": "Person",
                "name": "exfly"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="ExflyBlog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span>ExflyBlog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/about/"> 关于 </a><a class="menu-item" href="https://github.com/exfly" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i>  </a><a class="menu-item" href="/about/" title="关于"> 关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a><a href="javascript:void(0);" class="menu-item language" title="选择语言">
                    <i class="fa fa-globe" aria-hidden="true"></i>                      
                    <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/experiment-to-understand-how-hyperthreading-works/" selected>简体中文</option></select>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="ExflyBlog"><span class="header-title-pre"><i class='far fa-kiss-wink-heart fa-fw' aria-hidden='true'></i></span>ExflyBlog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/about/" title="">关于</a><a class="menu-item" href="https://github.com/exfly" title="GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw' aria-hidden='true'></i></a><a class="menu-item" href="/about/" title="关于">关于</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">
                    <i class="fa fa-globe fa-fw" aria-hidden="true"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/experiment-to-understand-how-hyperthreading-works/" selected>简体中文</option></select>
                </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">超线程是如何工作的 - 实验</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/exfly/" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>exfly</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2024-11-03">2024-11-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;约 2898 字&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;预计阅读 6 分钟&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#背景">背景</a></li>
    <li><a href="#实验环境信息">实验环境信息</a>
      <ul>
        <li><a href="#编译运行环境">编译运行环境</a></li>
      </ul>
    </li>
    <li><a href="#实验主体">实验主体</a>
      <ul>
        <li><a href="#测试-nop-指令">测试 nop 指令</a></li>
        <li><a href="#测试-pause-指令">测试 pause 指令</a></li>
        <li><a href="#测试-nop-指令跑两份各自绑定到同一物理核">测试 nop 指令跑两份各自绑定到同一物理核</a></li>
        <li><a href="#测试-pause-指令跑两份各自绑定到同一物理核">测试 pause 指令跑两份各自绑定到同一物理核</a></li>
        <li><a href="#测试-pausenop-指令各自绑定到同一物理核">测试 pause/nop 指令各自绑定到同一物理核</a></li>
      </ul>
    </li>
    <li><a href="#待解答问题">待解答问题</a>
      <ul>
        <li><a href="#为什么死循环里要写这么多-pausenop少了是什么因素导致的-ipc-降低呢">为什么死循环里要写这么多 pause/nop，少了，是什么因素导致的 IPC 降低呢？</a></li>
        <li><a href="#有什么方式可以查看当前-cpu-的流水线长度吗">有什么方式可以查看当前 CPU 的流水线长度吗？</a></li>
      </ul>
    </li>
    <li><a href="#总结">总结</a></li>
    <li><a href="#ref">ref</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p>文章简介：通过一个实验理解超线程是如何工作的</p>
<h2 id="背景">背景</h2>
<p>学习 CPU 超线程的时候，实践一下 plantegg 大佬的实验。实验大概是这样的：</p>
<p>写一个能把 IPC（instructions per cycle）跑到最高的代码 (可以试试跑一段死循环的 IPC 能到多少)；写一个能把 IPC 跑到最低的程序。然后用 perf 去看他们的 IPC，用 top 去看他们的 CPU 使用率。进一步同时把这样的程序跑两份，但是将他们绑到一对超线程上，然后再看他们的 IPC 以及 top。</p>
<p>nop.c</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">__asm__</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;nop&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>pause.c</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">while</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nf">__asm__</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause</span><span class="se">\n\t</span><span class="s">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="s">&#34;pause&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="实验环境信息">实验环境信息</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">root@localhost# cat /etc/redhat-release 
</span></span><span class="line"><span class="cl">Rocky Linux release 8.10 <span class="o">(</span>Green Obsidian<span class="o">)</span>
</span></span><span class="line"><span class="cl">root@localhost# uname -a
</span></span><span class="line"><span class="cl">Linux localhost.localdomain 3.10.0-1160.el7.x86_64 <span class="c1">#1 SMP Mon Oct 19 16:18:59 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span><span class="line"><span class="cl">root@localhost# lscpu
</span></span><span class="line"><span class="cl">Architecture:        x86_64
</span></span><span class="line"><span class="cl">CPU op-mode<span class="o">(</span>s<span class="o">)</span>:      32-bit, 64-bit
</span></span><span class="line"><span class="cl">Byte Order:          Little Endian
</span></span><span class="line"><span class="cl">CPU<span class="o">(</span>s<span class="o">)</span>:              <span class="m">80</span>
</span></span><span class="line"><span class="cl">On-line CPU<span class="o">(</span>s<span class="o">)</span> list: 0-79
</span></span><span class="line"><span class="cl">Thread<span class="o">(</span>s<span class="o">)</span> per core:  <span class="m">2</span>
</span></span><span class="line"><span class="cl">Core<span class="o">(</span>s<span class="o">)</span> per socket:  <span class="m">20</span>
</span></span><span class="line"><span class="cl">Socket<span class="o">(</span>s<span class="o">)</span>:           <span class="m">2</span>
</span></span><span class="line"><span class="cl">NUMA node<span class="o">(</span>s<span class="o">)</span>:        <span class="m">2</span>
</span></span><span class="line"><span class="cl">Vendor ID:           GenuineIntel
</span></span><span class="line"><span class="cl">BIOS Vendor ID:      Intel<span class="o">(</span>R<span class="o">)</span> Corporation
</span></span><span class="line"><span class="cl">CPU family:          <span class="m">6</span>
</span></span><span class="line"><span class="cl">Model:               <span class="m">85</span>
</span></span><span class="line"><span class="cl">Model name:          Intel<span class="o">(</span>R<span class="o">)</span> Xeon<span class="o">(</span>R<span class="o">)</span> Gold 5218R CPU @ 2.10GHz
</span></span><span class="line"><span class="cl">BIOS Model name:     Intel<span class="o">(</span>R<span class="o">)</span> Xeon<span class="o">(</span>R<span class="o">)</span> Gold 5218R CPU @ 2.10GHz
</span></span><span class="line"><span class="cl">Stepping:            <span class="m">7</span>
</span></span><span class="line"><span class="cl">CPU MHz:             799.932
</span></span><span class="line"><span class="cl">CPU max MHz:         4000.0000
</span></span><span class="line"><span class="cl">CPU min MHz:         800.0000
</span></span><span class="line"><span class="cl">BogoMIPS:            4200.00
</span></span><span class="line"><span class="cl">Virtualization:      VT-x
</span></span><span class="line"><span class="cl">L1d cache:           32K
</span></span><span class="line"><span class="cl">L1i cache:           32K
</span></span><span class="line"><span class="cl">L2 cache:            1024K
</span></span><span class="line"><span class="cl">L3 cache:            28160K
</span></span><span class="line"><span class="cl">NUMA node0 CPU<span class="o">(</span>s<span class="o">)</span>:   0-19,40-59
</span></span><span class="line"><span class="cl">NUMA node1 CPU<span class="o">(</span>s<span class="o">)</span>:   20-39,60-79
</span></span><span class="line"><span class="cl">Flags:               fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc aperfmperf eagerfpu pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_timer aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch epb cat_l3 cdp_l3 invpcid_single intel_ppin intel_pt ssbd mba ibrs ibpb stibp ibrs_enhanced tpr_shadow vnmi flexpriority ept vpid fsgsbase tsc_adjust bmi1 hle avx2 smep bmi2 erms invpcid rtm cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 cqm_llc cqm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts hwp hwp_act_window hwp_epp hwp_pkg_req pku ospke avx512_vnni md_clear spec_ctrl intel_stibp flush_l1d arch_capabilities
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">numactl -H
</span></span><span class="line"><span class="cl">available: <span class="m">2</span> nodes <span class="o">(</span>0-1<span class="o">)</span>
</span></span><span class="line"><span class="cl">node <span class="m">0</span> cpus: <span class="m">0</span> <span class="m">1</span> <span class="m">2</span> <span class="m">3</span> <span class="m">4</span> <span class="m">5</span> <span class="m">6</span> <span class="m">7</span> <span class="m">8</span> <span class="m">9</span> <span class="m">10</span> <span class="m">11</span> <span class="m">12</span> <span class="m">13</span> <span class="m">14</span> <span class="m">15</span> <span class="m">16</span> <span class="m">17</span> <span class="m">18</span> <span class="m">19</span> <span class="m">40</span> <span class="m">41</span> <span class="m">42</span> <span class="m">43</span> <span class="m">44</span> <span class="m">45</span> <span class="m">46</span> <span class="m">47</span> <span class="m">48</span> <span class="m">49</span> <span class="m">50</span> <span class="m">51</span> <span class="m">52</span> <span class="m">53</span> <span class="m">54</span> <span class="m">55</span> <span class="m">56</span> <span class="m">57</span> <span class="m">58</span> <span class="m">59</span>
</span></span><span class="line"><span class="cl">node <span class="m">0</span> size: <span class="m">128410</span> MB
</span></span><span class="line"><span class="cl">node <span class="m">0</span> free: <span class="m">52082</span> MB
</span></span><span class="line"><span class="cl">node <span class="m">1</span> cpus: <span class="m">20</span> <span class="m">21</span> <span class="m">22</span> <span class="m">23</span> <span class="m">24</span> <span class="m">25</span> <span class="m">26</span> <span class="m">27</span> <span class="m">28</span> <span class="m">29</span> <span class="m">30</span> <span class="m">31</span> <span class="m">32</span> <span class="m">33</span> <span class="m">34</span> <span class="m">35</span> <span class="m">36</span> <span class="m">37</span> <span class="m">38</span> <span class="m">39</span> <span class="m">60</span> <span class="m">61</span> <span class="m">62</span> <span class="m">63</span> <span class="m">64</span> <span class="m">65</span> <span class="m">66</span> <span class="m">67</span> <span class="m">68</span> <span class="m">69</span> <span class="m">70</span> <span class="m">71</span> <span class="m">72</span> <span class="m">73</span> <span class="m">74</span> <span class="m">75</span> <span class="m">76</span> <span class="m">77</span> <span class="m">78</span> <span class="m">79</span>
</span></span><span class="line"><span class="cl">node <span class="m">1</span> size: <span class="m">128985</span> MB
</span></span><span class="line"><span class="cl">node <span class="m">1</span> free: <span class="m">120673</span> MB
</span></span><span class="line"><span class="cl">node distances:
</span></span><span class="line"><span class="cl">node   <span class="m">0</span>   <span class="m">1</span> 
</span></span><span class="line"><span class="cl">  0:  <span class="m">10</span>  <span class="m">21</span> 
</span></span><span class="line"><span class="cl">  1:  <span class="m">21</span>  <span class="m">10</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">lstopo-no-graphics --output-format svg &gt; IntelRXeonGold5218R.svg
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="./images/IntelRXeonGold5218R.svg"
        data-srcset="./images/IntelRXeonGold5218R.svg, ./images/IntelRXeonGold5218R.svg 1.5x, ./images/IntelRXeonGold5218R.svg 2x"
        data-sizes="auto"
        alt="./images/IntelRXeonGold5218R.svg"
        title="IntelRXeonGold5218R topo" /></p>
<p>我的环境比较奇怪，宿主机的系统是 centos7.9，重装系统会相对麻烦一些。centos 已经 EOL，直接宿主机安装各种需要的软件、搭建编译环境相对麻烦，且我的电脑是 M1 arm，搭建交叉编译环境会涉及修改编译命令，入门门槛相对较高。所以尝试在 docker 中搭建运行、编译环境。环境如下：</p>
<h3 id="编译运行环境">编译运行环境</h3>
<p>Dockerfile 见如下，文件保存到 <code>tools/Dockerfile.labs</code>：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">FROM --platform<span class="o">=</span>linux/amd64 rockylinux/rockylinux:8
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">RUN dnf groupinstall -y <span class="s1">&#39;Development Tools&#39;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    <span class="o">&amp;&amp;</span> dnf --enablerepo<span class="o">=</span>devel -y install bison byacc flex patch glibc-static git libtirpc libtirpc-devel numactl numa* hwloc perf tmux
</span></span></code></pre></td></tr></table>
</div>
</div><p>编译 docker 镜像</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker build -f tools/Dockerfile.labs -t cpulabs:dev .
</span></span></code></pre></td></tr></table>
</div>
</div><p>只使用镜像中的 linux 发行版 rootfs，其他所有的隔离手段不使用，尽可能匹配宿主机裸机执行的环境：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">docker run --name casestudy --rm -it --privileged --userns<span class="o">=</span>host --network<span class="o">=</span>host --pid<span class="o">=</span>host -v <span class="k">$(</span><span class="nb">pwd</span><span class="k">)</span>:/host -w /host cpulabs:dev bash
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="实验主体">实验主体</h2>
<h3 id="测试-nop-指令">测试 nop 指令</h3>
<p>理论上 intel 4 条流水线并行，nop 执行需要一个时钟周期，cpu 完全跑 nop 指令的 IPC 大约是 4。接下来验证一下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc ./nop.c -o nop
</span></span></code></pre></td></tr></table>
</div>
</div><p>执行测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">perf stat timeout <span class="m">10</span> ./nop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 10 ./nop&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           9977.71 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">8</span>      context-switches          <span class="c1">#    0.802 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">2</span>      cpu-migrations            <span class="c1">#    0.200 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">511</span>      page-faults               <span class="c1">#   51.214 /sec                   </span>
</span></span><span class="line"><span class="cl">       <span class="m">38351130635</span>      cycles                    <span class="c1">#    3.844 GHz                    </span>
</span></span><span class="line"><span class="cl">      <span class="m">149695103720</span>      instructions              <span class="c1">#    3.90  insn per cycle         </span>
</span></span><span class="line"><span class="cl">        <span class="m">1168639909</span>      branches                  <span class="c1">#  117.125 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">465623</span>      branch-misses             <span class="c1">#    0.04% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      10.002747608 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       9.977095000 seconds user
</span></span><span class="line"><span class="cl">       0.001750000 seconds sys
</span></span></code></pre></td></tr></table>
</div>
</div><p>现象：</p>
<ul>
<li>IPC 跑到 3.90</li>
<li>CPUs util 0.997</li>
</ul>
<p>问题：</p>
<ul>
<li>IPC 跟 perf 执行多久无关，但是执行时间过短，IPC 计数会小一点点，猜测可能是时间太短，while 循环也需要执行执行，跳转指令让指令流水线受阻导致的，长时间的执行令分支预测更加准确，IPC 趋于稳定
<ul>
<li><code>perf stat timeout 0.1 ./nop</code> IPC 在 3.84</li>
<li><code>perf stat timeout 1 ./nop</code> IPC 在 3.90</li>
</ul>
</li>
<li>IPC 是否可以接近 4?
<ul>
<li>据说 intel 流水线可达 4 条并行，理论值是 4，while 循环也会转换成其他命令，会稀释一部分导致 IPC 降低，可以考虑增加 asm 中的 nop 的数量</li>
</ul>
</li>
</ul>
<h3 id="测试-pause-指令">测试 pause 指令</h3>
<p>理论上 intel 共 4 条流水线并行，一个 pause 指令大概 140 时钟周期，4/140=0.02857142857142857，接下来验证一下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">gcc ./pause.c -o pause
</span></span></code></pre></td></tr></table>
</div>
</div><p>执行测试</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">perf stat timeout <span class="m">10</span> ./pause
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 10 ./pause&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           9980.35 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">6</span>      context-switches          <span class="c1">#    0.601 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">3</span>      cpu-migrations            <span class="c1">#    0.301 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">510</span>      page-faults               <span class="c1">#   51.100 /sec                   </span>
</span></span><span class="line"><span class="cl">       <span class="m">35500797866</span>      cycles                    <span class="c1">#    3.557 GHz                    </span>
</span></span><span class="line"><span class="cl">         <span class="m">929191714</span>      instructions              <span class="c1">#    0.03  insn per cycle         </span>
</span></span><span class="line"><span class="cl">          <span class="m">15430712</span>      branches                  <span class="c1">#    1.546 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">373753</span>      branch-misses             <span class="c1">#    2.42% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      10.005685906 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       9.979564000 seconds user
</span></span><span class="line"><span class="cl">       0.002129000 seconds sys
</span></span></code></pre></td></tr></table>
</div>
</div><p>现象：</p>
<ul>
<li>IPC 大约 0.03，估计是精度问题，与计算出的理论值接近。</li>
</ul>
<h3 id="测试-nop-指令跑两份各自绑定到同一物理核">测试 nop 指令跑两份各自绑定到同一物理核</h3>
<blockquote>
<p>cat /proc/cpuinfo 中 希望找到相同物理核心的两个超线程，即寻找 core id 相同 且 physical id 相同的 两个 processor 即可。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">0</span> ./nop <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">40</span> ./nop
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;taskset -c 40 ./nop&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           6668.00 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">2</span>      context-switches          <span class="c1">#    0.300 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.150 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">343</span>      page-faults               <span class="c1">#   51.440 /sec                   </span>
</span></span><span class="line"><span class="cl">       <span class="m">21645830628</span>      cycles                    <span class="c1">#    3.246 GHz                    </span>
</span></span><span class="line"><span class="cl">       <span class="m">32415527643</span>      instructions              <span class="c1">#    1.50  insn per cycle         </span>
</span></span><span class="line"><span class="cl">         <span class="m">256383559</span>      branches                  <span class="c1">#   38.450 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">273069</span>      branch-misses             <span class="c1">#    0.11% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       6.684805024 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       6.666732000 seconds user
</span></span><span class="line"><span class="cl">       0.001996000 seconds sys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 3 taskset -c 40 ./nop&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           3000.46 msec task-clock                <span class="c1">#    0.996 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">6</span>      context-switches          <span class="c1">#    2.000 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.333 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">740</span>      page-faults               <span class="c1">#  246.629 /sec                   </span>
</span></span><span class="line"><span class="cl">       <span class="m">10749571656</span>      cycles                    <span class="c1">#    3.583 GHz                    </span>
</span></span><span class="line"><span class="cl">       <span class="m">19580067188</span>      instructions              <span class="c1">#    1.82  insn per cycle         </span>
</span></span><span class="line"><span class="cl">         <span class="m">155065143</span>      branches                  <span class="c1">#   51.680 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">159560</span>      branch-misses             <span class="c1">#    0.10% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.013625515 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       2.995919000 seconds user
</span></span><span class="line"><span class="cl">       0.008434000 seconds sys
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以看到两个 nop 跑在相同物理核的两个超线程下，IPC 下降到原来的一半以下了。</p>
<blockquote>
<p>(1.50+1.82)/(3.90*2)=0.42</p>
</blockquote>
<h3 id="测试-pause-指令跑两份各自绑定到同一物理核">测试 pause 指令跑两份各自绑定到同一物理核</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">0</span> ./pause <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">40</span> ./pause
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 3 taskset -c 40 ./pause&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           3000.71 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">5</span>      context-switches          <span class="c1">#    1.666 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.333 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">740</span>      page-faults               <span class="c1">#  246.608 /sec                   </span>
</span></span><span class="line"><span class="cl">        <span class="m">9127896305</span>      cycles                    <span class="c1">#    3.042 GHz                    </span>
</span></span><span class="line"><span class="cl">         <span class="m">232869301</span>      instructions              <span class="c1">#    0.03  insn per cycle         </span>
</span></span><span class="line"><span class="cl">           <span class="m">5153047</span>      branches                  <span class="c1">#    1.717 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">149048</span>      branch-misses             <span class="c1">#    2.89% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.008989678 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       2.996138000 seconds user
</span></span><span class="line"><span class="cl">       0.005710000 seconds sys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 3 taskset -c 0 ./pause&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           3002.08 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">8</span>      context-switches          <span class="c1">#    2.665 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.333 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">740</span>      page-faults               <span class="c1">#  246.496 /sec                   </span>
</span></span><span class="line"><span class="cl">        <span class="m">9036205346</span>      cycles                    <span class="c1">#    3.010 GHz                    </span>
</span></span><span class="line"><span class="cl">         <span class="m">228681050</span>      instructions              <span class="c1">#    0.03  insn per cycle         </span>
</span></span><span class="line"><span class="cl">           <span class="m">4910490</span>      branches                  <span class="c1">#    1.636 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">151013</span>      branch-misses             <span class="c1">#    3.08% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.010698825 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.000847000 seconds user
</span></span><span class="line"><span class="cl">       0.002973000 seconds sys
</span></span></code></pre></td></tr></table>
</div>
</div><p>现象：</p>
<ul>
<li>绑定在 0 号 CPU 上的 IPC 为 0.03，绑定到 40 号 CPU 上的 IPC 为 0.03，与原始跑一个 pause 时一样</li>
</ul>
<h3 id="测试-pausenop-指令各自绑定到同一物理核">测试 pause/nop 指令各自绑定到同一物理核</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">0</span> ./nop <span class="p">&amp;</span>
</span></span><span class="line"><span class="cl">perf stat timeout <span class="m">3</span> taskset -c <span class="m">40</span> ./pause
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 3 taskset -c 0 ./nop&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           3004.09 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">9</span>      context-switches          <span class="c1">#    2.996 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.333 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">741</span>      page-faults               <span class="c1">#  246.663 /sec                   </span>
</span></span><span class="line"><span class="cl">        <span class="m">8734459274</span>      cycles                    <span class="c1">#    2.908 GHz                    </span>
</span></span><span class="line"><span class="cl">       <span class="m">27382699175</span>      instructions              <span class="c1">#    3.14  insn per cycle         </span>
</span></span><span class="line"><span class="cl">         <span class="m">215882285</span>      branches                  <span class="c1">#   71.863 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">170322</span>      branch-misses             <span class="c1">#    0.08% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.013204769 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       2.999945000 seconds user
</span></span><span class="line"><span class="cl">       0.006140000 seconds sys
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> Performance counter stats <span class="k">for</span> <span class="s1">&#39;timeout 3 taskset -c 40 ./pause&#39;</span>:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">           2997.37 msec task-clock                <span class="c1">#    0.997 CPUs utilized          </span>
</span></span><span class="line"><span class="cl">                 <span class="m">5</span>      context-switches          <span class="c1">#    1.668 /sec                   </span>
</span></span><span class="line"><span class="cl">                 <span class="m">1</span>      cpu-migrations            <span class="c1">#    0.334 /sec                   </span>
</span></span><span class="line"><span class="cl">               <span class="m">738</span>      page-faults               <span class="c1">#  246.216 /sec                   </span>
</span></span><span class="line"><span class="cl">        <span class="m">8791793294</span>      cycles                    <span class="c1">#    2.933 GHz                    </span>
</span></span><span class="line"><span class="cl">         <span class="m">219616224</span>      instructions              <span class="c1">#    0.02  insn per cycle         </span>
</span></span><span class="line"><span class="cl">           <span class="m">5261702</span>      branches                  <span class="c1">#    1.755 M/sec                  </span>
</span></span><span class="line"><span class="cl">            <span class="m">144141</span>      branch-misses             <span class="c1">#    2.74% of all branches        </span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       3.005700376 seconds <span class="nb">time</span> elapsed
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       2.992557000 seconds user
</span></span><span class="line"><span class="cl">       0.006074000 seconds sys
</span></span></code></pre></td></tr></table>
</div>
</div><p>现象：</p>
<ul>
<li>计算当前 IPC 是跑在两个物理核心上的 (3.14+0.02)/(3.90+0.03) = 0.80，比同时跑 nop 的 0.42 提高明显。</li>
</ul>
<h2 id="待解答问题">待解答问题</h2>
<h3 id="为什么死循环里要写这么多-pausenop少了是什么因素导致的-ipc-降低呢">为什么死循环里要写这么多 pause/nop，少了，是什么因素导致的 IPC 降低呢？</h3>
<h3 id="有什么方式可以查看当前-cpu-的流水线长度吗">有什么方式可以查看当前 CPU 的流水线长度吗？</h3>
<p>TODO:</p>
<h2 id="总结">总结</h2>
<ul>
<li>学习了 perf 命令监控程序性能</li>
<li>学习了 taskset 命令控制绑核</li>
<li>学习了超线程相关信息</li>
</ul>
<p>上面学习到的都是需要后续深入研究。</p>
<h2 id="ref">ref</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Instructions_per_cycle?useskin=vector" target="_blank" rel="noopener noreffer ">IPC(Instructions per cycle)</a></li>
<li><a href="https://en.wikipedia.org/wiki/NOP_%28code%29?useskin=vector" target="_blank" rel="noopener noreffer ">NOP (code)</a></li>
<li><a href="https://en.wikipedia.org/wiki/X86_instruction_listings?useskin=vector" target="_blank" rel="noopener noreffer ">X86_instruction_listings</a></li>
<li><a href="https://juejin.cn/post/6910489270054715400" target="_blank" rel="noopener noreffer ">说说如何判断 Linux 是否开启了超线程</a></li>
<li><a href="https://plantegg.github.io/2021/05/16/Perf_IPC%E4%BB%A5%E5%8F%8ACPU%E5%88%A9%E7%94%A8%E7%8E%87/" target="_blank" rel="noopener noreffer ">Perf IPC 以及 CPU 性能</a></li>
</ul></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2024-11-03&nbsp;<a class="git-hash" href="https://github.com/exfly/HugoBlog/commit/8bc8db6288cd56af2e8db88a787f95f2ba4bac96" target="_blank" title="commit by exfly(exflyg@gmail.com) 8bc8db6288cd56af2e8db88a787f95f2ba4bac96: feat: add pause/nop">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>8bc8db6</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" data-title="超线程是如何工作的 - 实验" data-hashtags="debug,cpu,intel,"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" data-hashtag="debug"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" data-title="超线程是如何工作的 - 实验"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" data-title="超线程是如何工作的 - 实验"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://exfly.github.io/experiment-to-understand-how-hyperthreading-works/" data-title="超线程是如何工作的 - 实验"><i class="fab fa-weibo fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/debug/">debug</a>,&nbsp;<a href="/tags/cpu/">cpu</a>,&nbsp;<a href="/tags/intel/">intel</a>,&nbsp;<a href="/tags/">Tags</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/why-sysbench-dont-reconnect-after-kill/" class="prev" rel="prev" title="sysbench benchmark MySQL 时候，为什么 kill 连接后，sysbench 没有重连"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>sysbench benchmark MySQL 时候，为什么 kill 连接后，sysbench 没有重连</a></div>
</div>
<div id="comments"><div id="giscus" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://giscus.app">Giscus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">由 <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.122.0">Hugo</a> 强力驱动 | 主题 - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/exfly/" target="_blank">exfly</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":50},"comment":{"giscus":{"category":"Announcements","categoryId":"DIC_kwDOBCuJFs4CT0-J","darkTheme":"dark","emitMetadata":"0","inputPosition":"top","lang":"zh-CN","lazyLoading":false,"lightTheme":"light","mapping":"pathname","reactionsEnabled":"1","repo":"exfly/exfly.github.io","repoId":"MDEwOlJlcG9zaXRvcnk2OTk2MjAwNg=="}},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.zh-cn","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script><script type="text/javascript">
            window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());
            gtag('config', 'G-6XWGXY4X6W', { 'anonymize_ip': true });
        </script><script type="text/javascript" src="https://www.googletagmanager.com/gtag/js?id=G-6XWGXY4X6W" async></script></body>
</html>
